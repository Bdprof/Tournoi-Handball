<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="manifest" href="manifest.json">
    <title>Tournoi d'Ultimate</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background: #f0f0f0;
        }
        .container {
            padding: 20px;
        }
        .btn {
            display: inline-block;
            padding: 10px 15px;
            margin: 8px 0;
            background: #2196F3;
            color: white;
            text-align: center;
            border-radius: 5px;
            cursor: pointer;
        }
        .btn:hover {
            opacity: 0.9;
        }
        .hidden {
            display: none;
        }
        .card {
            background: white;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
    </style>
</head>
<body>
    <div class="container" id="pageAccueil">
        <h2>Tournoi d'Ultimate</h2>
        <div class="card">
            <label>Nombre d'équipes :</label>
            <select id="nbEquipes">
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
            </select>
            <div class="btn" onclick="genererEquipes()">Commencer →</div>
        </div>
    </div>

    <div class="container hidden" id="pageEquipes">
        <h2>Nom des équipes</h2>
        <div id="listeEquipes"></div>
        <div class="btn" onclick="genererTournoi()">Générer le tournoi</div>
    </div>

    <div class="container hidden" id="pageTournoi">
        <h2>Matchs</h2>
        <div id="listeMatchs"></div>
        <div class="btn" onclick="afficherStats()">Voir statistiques</div>
    </div>

    <div class="container hidden" id="pageStats">
        <h2>Statistiques</h2>
        <div id="stats"></div>
        <div class="btn" onclick="retourAccueil()">Retour accueil</div>
    </div>

    <script>
        let equipes = [];
        let matchs = [];

        function changerPage(id) {
            document.querySelectorAll('.container').forEach(p => p.classList.add('hidden'));
            document.getElementById(id).classList.remove('hidden');
        }

        function genererEquipes() {
            let nb = parseInt(document.getElementById('nbEquipes').value);
            equipes = [];
            let html = '';
            for (let i=1; i<=nb; i++) {
                html += `<div class='card'><label>Équipe ${i} :</label><input id='equipe${i}'></div>`;
            }
            document.getElementById('listeEquipes').innerHTML = html;
            changerPage('pageEquipes');
        }

        function genererTournoi() {
            const nb = document.getElementById('nbEquipes').value;
            equipes = [];
            for (let i=1; i<=nb; i++) {
                equipes.push(document.getElementById(`equipe${i}`).value || `Équipe ${i}`);
            }
            matchs = [];
            for (let i=0; i<equipes.length; i++) {
                for (let j=i+1; j<equipes.length; j++) {
                    matchs.push({ a: equipes[i], b: equipes[j], scoreA:null, scoreB:null });
                }
            }
            let html = '';
            matchs.forEach((m, i) => {
                html += `<div class='card'>${m.a} vs ${m.b}<br>
                    <input type='number' placeholder='Score ${m.a}' onchange='updateScore(${i},"A",this.value)'>
                    <input type='number' placeholder='Score ${m.b}' onchange='updateScore(${i},"B",this.value)'></div>`;
            });
            document.getElementById('listeMatchs').innerHTML = html;
            changerPage('pageTournoi');
        }

        function updateScore(i, team, val) {
            if (team == "A") matchs[i].scoreA = parseInt(val);
            else matchs[i].scoreB = parseInt(val);
        }

        function afficherStats() {
            let scores = {};
            equipes.forEach(e => scores[e] = 0);
            matchs.forEach(m => {
                if (m.scoreA != null && m.scoreB != null) {
                    if (m.scoreA > m.scoreB) scores[m.a]++;
                    else if (m.scoreB > m.scoreA) scores[m.b]++;
                }
            });
            let html = '';
            Object.keys(scores).forEach(e => {
                html += `<div class='card'>${e} : ${scores[e]} victoires</div>`;
            });
            document.getElementById('stats').innerHTML = html;
            changerPage('pageStats');
        }

        function retourAccueil() {
            changerPage('pageAccueil');
        }

        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('service-worker.js');
        }
    </script>
</body>
</html>
